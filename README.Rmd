---
output:
  github_document:
    pandoc_args: --webtex
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```
[![Travis build status](https://travis-ci.org/Jaimemosg/EstimationTools.svg?branch=master)](https://travis-ci.org/Jaimemosg/EstimationTools)
[![AppVeyor Build Status](https://ci.appveyor.com/api/projects/status/github/Jaimemosg/EstimationTools?branch=master&svg=true)](https://ci.appveyor.com/project/Jaimemosg/EstimationTools)
[![CRAN\_Status\_Badge](http://www.r-pkg.org/badges/version-ago/EstimationTools)](https://cran.r-project.org/package=EstimationTools)
[![Project Status: Active â€“ The project has reached a stable, usable state and is being actively developed.](https://www.repostatus.org/badges/latest/active.svg)](https://www.repostatus.org/#active)
[![CRAN\_Download\_Badge](http://cranlogs.r-pkg.org/badges/EstimationTools)](https://cran.r-project.org/package=EstimationTools) 
[![Licence](https://img.shields.io/badge/licence-GPL--3-blue.svg)](https://www.gnu.org/licenses/gpl-3.0.en.html)
<!-- [![Dependencies](https://tinyverse.netlify.com/badge/EstimationTools)](https://cran.r-project.org/package=EstimationTools) -->

# EstimationTools <img src="man/figure/ETLogo.png" align="right" height="200" align="right"/>

<!-- badges: start -->
<!-- badges: end -->

The goal of `EstimationTools` is to provide a routine for parameter estimation of probability density/mass functions in `R`.

## Installation

You can install the lastest version of `EstimationTools` typing the following command lines
in `R` console:

``` {r eval=FALSE}
if (!require('devtools')) install.packages('devtools')
devtools::install_github('Jaimemosg/EstimationTools', force = TRUE)
library(EstimationTools)
```

Or you can install the released version from  [CRAN](https://cran.r-project.org/package=EstimationTools) if you prefer. You can also type the following command lines
in `R` console:

```{r eval=FALSE}
install.packages("EstimationTools")
```

You can visit the [package website](https://Jaimemosg.github.io/EstimationTools/) to explore the vignettes (articles) and functions reference. 

# Examples

These are basic examples which shows you how to solve a common maximum likelihood estimation problem with `EstimationTools`:

## Estimation in regression models

<!-- The data is from [NIST](https://www.itl.nist.gov/div898/handbook/apr/section2/apr221.htm#Example). They generated  20 random Weibull failure times with a parameter `shape=1.5` and `scale=500`. The test time is 500 hours, 10 of these failure times are right censored. The observed times are, to the nearest hour: 54, 187, 216, 240, 244, 335, 361, 373, 375, and 386. -->

```{r, echo=FALSE}
tcens1 <- qweibull(0.1, shape = exp(1.5), scale = exp(6.214608), lower.tail = FALSE)
tcens2 <- qweibull(0.1, shape = exp(1.5+0.3), scale = exp(6.214608), lower.tail = FALSE)
tcens <- min(tcens1, tcens2)
t1 <- rweibull(n = 15, shape = exp(1.5), scale = exp(6.214608))
t2 <- rweibull(n = 15, shape = exp(1.5+0.3), scale = exp(6.214608))

t0 <- c(t1, t2)
t_sim <- ifelse(t0 < tcens, t0, tcens)
status <- as.numeric(t_sim < tcens)
group <- c(rep(0, 15), rep(1, 15))
```

We generate data from an hypothetic failure test of `r round(tcens1, 2)` hours. 10% of the data is right censored; the data is showed just above:

```{r, echo=FALSE}
data.frame(t_sim=t_sim, status=status, group=group)[1:6,]
```


The model is as follows:

$$
f(t|\alpha, k) = \frac{\alpha}{k} \left(\frac{t}{k}\right)^{\alpha-1} \exp\left[-\left(\frac{t}{k}\right)^{\alpha}\right]
$$

\centering
$$
\begin{aligned}
T &\stackrel{\text{iid.}}{\sim} WEI(\alpha,\: k), \\
\alpha &= 1.5 + 0.3 \times group \quad  (\verb|shape|),\\
k &= 500 \quad (\verb|scale|).
\end{aligned}
$$

The implementation and its solution is printed below:

```{r example1, message=FALSE, warning=FALSE}
library(EstimationTools)

# Formulas with linear predictors
formulas <- list(scale.fo = ~ 1, shape.fo = ~ group)

# The model
fit_wei <- maxlogLreg(formulas, y_dist = Surv(t_sim, status) ~ dweibull,
                      link = list(over = c("shape", "scale"),
                                  fun = rep("log_link", 2)))
summary(fit_wei)
```

## Estimation in distributions

$$
\begin{aligned} 
X &\sim N(\mu, \:\sigma^2), \\
\mu &= 160 \quad (\verb|mean|), \\
\sigma &= 6 \quad (\verb|sd|).
\end{aligned}
$$

The solution for a data set generated with size $n=10000$ is showed below

```{r example2, message=FALSE, warning=FALSE}
x <- rnorm( n = 10000, mean = 160, sd = 6 )
fit <- maxlogL( x = x, dist = "dnorm", link = list(over = "sd", fun = "log_link") )
summary(fit)
```
