<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Maximum Likelihood Estimation for Probability Functions from Data Sets • EstimationTools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Maximum Likelihood Estimation for Probability Functions from Data Sets">
<meta property="og:description" content="Routines for parameter estimation for any probability density or
    mass function implemented in R via maximum likelihood (ML) given a data set. 
    The main routines maxlogL and maxlogLreg are  wrapper functions specifically 
    developed for ML estimation. There are included optimization procedures such as
    nlminb and optim from base package, and DEoptim Mullen (2011) 
    &lt;doi: 10.18637/jss.v040.i06&gt;. Standard errors are estimated with numDeriv 
    Gilbert (2011) &lt;http://CRAN.R-project.org/package=numDeriv&gt;
    or the option Hessian = TRUE of optim function.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">EstimationTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/Bootstrap_implementation.html">Bootstrap implementation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Jaimemosg/EstimationTools/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<div id="estimationtools-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#estimationtools-" class="anchor"></a>EstimationTools <img src="man/figure/ETLogo.png" align="right" height="200">
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The goal of <code>EstimationTools</code> is to provide a routine for parameter estimation of probability density/mass functions in <code>R</code>.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the lastest version of <code>EstimationTools</code> typing the following command lines in <code>R</code> console:</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="kw">if</span> (!<span class="fu"><a href="https://rdrr.io/r/base/library.html">require</a></span>(<span class="st">'devtools'</span>)) <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">'devtools'</span>)
<span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">'Jaimemosg/EstimationTools'</span>, <span class="kw">force</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">EstimationTools</span>)</pre></div>
<p>Or you can install the released version from <a href="https://cran.r-project.org/package=EstimationTools">CRAN</a> if you prefer. You can also type the following command lines in <code>R</code> console:</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"EstimationTools"</span>)</pre></div>
<p>You can visit the <a href="https://Jaimemosg.github.io/EstimationTools/">package website</a> to explore the vignettes (articles) and functions reference.</p>
</div>
</div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h1>
<p>These are basic examples which shows you how to solve a common maximum likelihood estimation problem with <code>EstimationTools</code>:</p>
<div id="estimation-in-regression-models" class="section level2">
<h2 class="hasAnchor">
<a href="#estimation-in-regression-models" class="anchor"></a>Estimation in regression models</h2>
<!-- The data is from [NIST](https://www.itl.nist.gov/div898/handbook/apr/section2/apr221.htm#Example). They generated  20 random Weibull failure times with a parameter `shape=1.5` and `scale=500`. The test time is 500 hours, 10 of these failure times are right censored. The observed times are, to the nearest hour: 54, 187, 216, 240, 244, 335, 361, 373, 375, and 386. -->
<p>We generate data from an hypothetic failure test of approximately 641 hours with 40 experimental units, 20 from group 1 and 20 from group 2. Lets assume a censorship rate of 10%, and regard that the data is right censored. Times from 6 of the 20 experimental units are shown just bellow:</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">RCurl</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">foreign</span>)

<span class="no">url_data</span> <span class="kw">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/Jaimemosg/EstimationTools/master/extra/sim_wei.csv"</span>
<span class="no">wei_data</span> <span class="kw">&lt;-</span> <span class="fu">getURL</span>(<span class="no">url_data</span>)
<span class="no">data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/textconnections.html">textConnection</a></span>(<span class="no">wei_data</span>), <span class="kw">header</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">data</span>$<span class="no">group</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">data</span>$<span class="no">group</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">data</span>)
<span class="co">#&gt;   label     Time status group</span>
<span class="co">#&gt; 1     2 172.7296      1     2</span>
<span class="co">#&gt; 2     5 198.5872      1     1</span>
<span class="co">#&gt; 3    13 284.9617      1     1</span>
<span class="co">#&gt; 4    18 289.8941      1     1</span>
<span class="co">#&gt; 5    20 293.4005      1     1</span>
<span class="co">#&gt; 6    15 303.5566      1     1</span></pre></div>
<p>The model is as follows:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af%28t%7C%5Calpha%2C%20k%29%20%3D%20%5Cfrac%7B%5Calpha%7D%7Bk%7D%20%5Cleft%28%5Cfrac%7Bt%7D%7Bk%7D%5Cright%29%5E%7B%5Calpha-1%7D%20%5Cexp%5Cleft%5B-%5Cleft%28%5Cfrac%7Bt%7D%7Bk%7D%5Cright%29%5E%7B%5Calpha%7D%5Cright%5D%0A%20%22%20f(t%7C%5Calpha,%20k)%20=%20%5Cfrac%7B%5Calpha%7D%7Bk%7D%20%5Cleft(%5Cfrac%7Bt%7D%7Bk%7D%5Cright)%5E%7B%5Calpha-1%7D%20%5Cexp%5Cleft%5B-%5Cleft(%5Cfrac%7Bt%7D%7Bk%7D%5Cright)%5E%7B%5Calpha%7D%5Cright%5D%20%22" alt="f(t|\alpha, k) = \frac{\alpha}{k} \left(\frac{t}{k}\right)^{\alpha-1} \exp\left-\\left(\\frac{t}{k}\\right)^{\\alpha}\\right"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AT%20%26%5Cstackrel%7B%5Ctext%7Biid.%7D%7D%7B%5Csim%7D%20WEI%28%5Calpha%2C%5C%3A%20k%29%2C%20%5C%5C%0A%5Clog%28%5Calpha%29%20%26%3D%201.2%20%2B%200.1%20%5Ctimes%20group%20%5Cquad%20%20%28%5Cverb%7Cshape%7C%29%2C%5C%5C%0Ak%20%26%3D%20500%20%5Cquad%20%28%5Cverb%7Cscale%7C%29.%0A%5Cend%7Baligned%7D%0A%20%22%20%5Cbegin%7Baligned%7D%20T%20&amp;%5Cstackrel%7B%5Ctext%7Biid.%7D%7D%7B%5Csim%7D%20WEI(%5Calpha,%5C:%20k),%20%5C%5C%20%5Clog(%5Calpha)%20&amp;=%201.2%20+%200.1%20%5Ctimes%20group%20%5Cquad%20(%5Cverb%7Cshape%7C),%5C%5C%20k%20&amp;=%20500%20%5Cquad%20(%5Cverb%7Cscale%7C).%20%5Cend%7Baligned%7D%20%22" alt="\begin{aligned} T &amp;\stackrel{\text{iid.}}{\sim} WEI(\alpha,\: k), \\ \log(\alpha) &amp;= 1.2 + 0.1 \times group \quad (\verb|shape|),\\ k &amp;= 500 \quad (\verb|scale|). \end{aligned}"></p>
<p>The implementation and its solution is printed below:</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">EstimationTools</span>)

<span class="co"># Formulas with linear predictors</span>
<span class="no">formulas</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">scale.fo</span> <span class="kw">=</span> ~ <span class="fl">1</span>, <span class="kw">shape.fo</span> <span class="kw">=</span> ~ <span class="no">group</span>)

<span class="co"># The model</span>
<span class="no">fit_wei</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/maxlogLreg.html">maxlogLreg</a></span>(<span class="no">formulas</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">data</span>,
                      <span class="kw">y_dist</span> <span class="kw">=</span> <span class="fu">Surv</span>(<span class="no">Time</span>, <span class="no">status</span>) ~ <span class="no">dweibull</span>,
                      <span class="kw">link</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">over</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"shape"</span>, <span class="st">"scale"</span>),
                                  <span class="kw">fun</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"log_link"</span>, <span class="fl">2</span>)))
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">fit_wei</span>)
<span class="co">#&gt; _______________________________________________________________</span>
<span class="co">#&gt; Optimization routine: nlminb </span>
<span class="co">#&gt; Standard Error calculation: Hessian from optim </span>
<span class="co">#&gt; _______________________________________________________________</span>
<span class="co">#&gt;        AIC      BIC</span>
<span class="co">#&gt;   472.4435 477.5101</span>
<span class="co">#&gt; _______________________________________________________________</span>
<span class="co">#&gt; Fixed effects for g(shape) </span>
<span class="co">#&gt; ---------------------------------------------------------------</span>
<span class="co">#&gt;             Estimate Std. Error Z value  Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)  1.16587    0.19960  5.8410 5.189e-09 ***</span>
<span class="co">#&gt; group2       0.30861    0.28990  1.0645    0.2871    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; _______________________________________________________________</span>
<span class="co">#&gt; Fixed effects for g(scale) </span>
<span class="co">#&gt; ---------------------------------------------------------------</span>
<span class="co">#&gt;             Estimate Std. Error Z value  Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)   6.2553     0.0463   135.1 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; _______________________________________________________________</span>
<span class="co">#&gt; Note: p-values valid under asymptotic normality of estimators </span>
<span class="co">#&gt; ---</span></pre></div>
</div>
<div id="estimation-in-distributions" class="section level2">
<h2 class="hasAnchor">
<a href="#estimation-in-distributions" class="anchor"></a>Estimation in distributions</h2>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%20%0AX%20%26%5Csim%20N%28%5Cmu%2C%20%5C%3A%5Csigma%5E2%29%2C%20%5C%5C%0A%5Cmu%20%26%3D%20160%20%5Cquad%20%28%5Cverb%7Cmean%7C%29%2C%20%5C%5C%0A%5Csigma%20%26%3D%206%20%5Cquad%20%28%5Cverb%7Csd%7C%29.%0A%5Cend%7Baligned%7D%0A%20%22%20%5Cbegin%7Baligned%7D%20X%20&amp;%5Csim%20N(%5Cmu,%20%5C:%5Csigma%5E2),%20%5C%5C%20%5Cmu%20&amp;=%20160%20%5Cquad%20(%5Cverb%7Cmean%7C),%20%5C%5C%20%5Csigma%20&amp;=%206%20%5Cquad%20(%5Cverb%7Csd%7C).%20%5Cend%7Baligned%7D%20%22" alt="\begin{aligned} X &amp;\sim N(\mu, \:\sigma^2), \\ \mu &amp;= 160 \quad (\verb|mean|), \\ \sigma &amp;= 6 \quad (\verb|sd|). \end{aligned}"></p>
<p>The solution for a data set generated with size <embed src="https://latex.codecogs.com/png.latex?n%3D10000" title="n=10000"></embed> is showed below</p>
<div class="sourceCode" id="cb5"><pre class="r"><span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>( <span class="kw">n</span> <span class="kw">=</span> <span class="fl">10000</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">160</span>, <span class="kw">sd</span> <span class="kw">=</span> <span class="fl">6</span> )
<span class="no">fit</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/maxlogL.html">maxlogL</a></span>( <span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">dist</span> <span class="kw">=</span> <span class="st">"dnorm"</span>, <span class="kw">link</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">over</span> <span class="kw">=</span> <span class="st">"sd"</span>, <span class="kw">fun</span> <span class="kw">=</span> <span class="st">"log_link"</span>) )
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">fit</span>)
<span class="co">#&gt; _______________________________________________________________</span>
<span class="co">#&gt; Optimization routine: nlminb </span>
<span class="co">#&gt; Standard Error calculation: Hessian from optim </span>
<span class="co">#&gt; _______________________________________________________________</span>
<span class="co">#&gt;        AIC      BIC</span>
<span class="co">#&gt;   64242.83 64257.25</span>
<span class="co">#&gt; _______________________________________________________________</span>
<span class="co">#&gt;      Estimate  Std. Error</span>
<span class="co">#&gt; mean  160.0410     0.0601</span>
<span class="co">#&gt; sd      6.0075     0.0425</span>
<span class="co">#&gt; _______________________________________________________________</span></pre></div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=EstimationTools">https://​cloud.r-project.org/​package=EstimationTools</a>
</li>
<li>Browse source code at <br><a href="https://github.com/Jaimemosg/EstimationTools/">https://​github.com/​Jaimemosg/​EstimationTools/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/Jaimemosg/EstimationTools/issues">https://​github.com/​Jaimemosg/​EstimationTools/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Jaime Mosquera <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-1684-4756" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Freddy Hernandez <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-7459-3329" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/Jaimemosg/EstimationTools"><img src="https://travis-ci.org/Jaimemosg/EstimationTools.svg?branch=master" alt="Travis build status"></a></li>
<li><a href="https://ci.appveyor.com/project/Jaimemosg/EstimationTools"><img src="https://ci.appveyor.com/api/projects/status/github/Jaimemosg/EstimationTools?branch=master&amp;svg=true" alt="AppVeyor Build Status"></a></li>
<li><a href="https://cran.r-project.org/package=EstimationTools"><img src="http://www.r-pkg.org/badges/version-ago/EstimationTools" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://www.repostatus.org/#active"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://cran.r-project.org/package=EstimationTools"><img src="http://cranlogs.r-pkg.org/badges/EstimationTools" alt="CRAN_Download_Badge"></a></li>
<li><a href="https://www.gnu.org/licenses/gpl-3.0.en.html"><img src="https://img.shields.io/badge/licence-GPL--3-blue.svg" alt="Licence"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Jaime Mosquera, Freddy Hernandez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
