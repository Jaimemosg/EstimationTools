---
title: "Bootstrap implementation"
author: "Jaime Mosquera"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Bootstrap implementation}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Bootstrap procedure

Objects of `maxogL` class (`maxlogL` and `maxlogLreg`) estimates parameters of probability density/mass functions by Maximum Likelihood. The variance-covariance matrix is computed from Fisher information matrix, which is obtained by means of the Inverse Hessian matrix of estimators:

\begin{equation}
Var(\hat{\boldsymbol{\theta}}) = I^{-1}(\hat{\boldsymbol{\theta}}) = C(\hat{\boldsymbol{\theta}}),
\end{equation}

where $I(\hat{\boldsymbol{\theta}})$ is the Fisher Information Matrix. Hence, the standard errors can be calculated as the square root of the diagonal elements of matrix $C$, as follows:

\begin{equation}
SE(\hat{\boldsymbol{\theta}}) = \sqrt{C_{jj}(\hat{\boldsymbol{\theta}})},
\end{equation}

To install the package, type the following commands:

```{r, eval=FALSE}
if (!require('devtools')) install.packages('devtools')
devtools::install_github('Jaimemosg/EstimationTools', force = TRUE)
```

The Hessian matrix is computed in the following way:

- Firstly, it is estimated through `optim`, with option `hessian = TRUE` in `maxlogL` function.
- If the previous implementation fails, it is calculated with `hessian` function from **numDeriv** package.
- If both of the previous methods fail, then standard errors are computed by bootstrapping.

Additionally, **EstimationTools** allows implementation of bootstrap for standard error estimation, even if the Hessian computation does not fail.

